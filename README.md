
# Hotspot and Shadow Detection for Solar Panels

## Overview
The aim of this project is to develop a system to detect criticalities in the operation of solar panels such as faults or shaded areas, through the use of basic computer vision techniques, and to predict the operability of the panels under these conditions. The developed system processes images acquired during the day by a fixed camera, leveraging tools such as pvlib to understand the characteristic IV PV curves of panels in real-time conditions, pursuing the ultimate goal of maximising energy production. 
Detecting shaded areas or faults on a solar panel is extremely important as these can significantly affect the efficiency of the panel, leading to:
    - Decreased Power Output: faults can lead to a reduction in power output, diminishing the amount of electricity generated by the solar panels, resulting in lower energy production;
    - Reduced Energy Harvesting: shadows cast on solar panels obstruct the incoming sunlight, so when a portion of a solar panel is shaded, it creates a “weakest link” effect, reducing the overall efficiency of the entire panel;
    - Hotspot and Potential Damage: when certain areas of a solar panel are shaded while others receive sunlight, a condition called partial shading or mismatch occurs, leading to the formation of hotspots, were excessive heat is generated due to the uneven flow of current. Hotspots can damage the solar cells and shorten their lifespan;
    - Increaded Wear and Tear: faults in electrical component or wiring can result in excessive resistance, leading to increased heat generation and potential degradation of the solar panels over time, reducing their overall longevity.

For all the above reasons, it is important to identify any faults or shadow zones early enough to be able to intervene, possibly by proposing a reconfiguration of the system layout and, if necessary, to trace the point of maximum power.

This type of problem is often addressed through the use of traditional techniques that require a pair of voltage/current sensors for each panel, making it necessary to employ large arrays of sensors. Instead, the implemented system employs an image-based approach to detect, localize and understand the dimension of faults and shadows on the solar panels, to propose a reconfiguration and use these information to estimate the electrical characteristics of the panels, obtaining a **costs** and **sizes reduction**, **increasing the reliability of the installation, not requiring a large number of sensors**.

## Proposed System
The proposed system is based on images acquired at fixed time from cameras mounted on panels installation. It performs, through the use of traditional artificial vision algorithms, a real-time detection of shadows and faults, starting from which it is possible to propose a reconfiguration. However, starting from the estimation of electical data, performed through the information obtained with image analysis, the system performs an estimation of the IV and PV characteristic curve. In order to test the developed system it has been used databases containing images of solar panels affected by faults or shaded areas, and also corresponding electircal data to be compared with the predicted one.
### Detection of faults 
Starting from thermal image, the potential fault is detected applying Canny and Hough algorithms and it is considered as a permanent situation only if the same potential anomaly is detected for more than three consecutive images. The proposed solution for this problem was inspired by this [paper](The proposed solution was inspired by this paper).
### Detection of shadows
Starting from the RGB image, the shadow is detected using the HSV image, combining different extracted binary masks and applying morphological operations. Then, the percentage and positioning of shaded areas is identified. The used images and the related electrical data are described and are available [here](https://www.mdpi.com/2306-5729/7/6/82). The downloaded dataset must be placed in a folder `ANALISI GUASTI/DATASET/` to correctly run the code.
### Prediction of the I-V curve
To predict the electrical data of the panel under different conditions it was necessary to obtain its characteristics from the datasheet. Unfortunately some values like those related to bypass diode are not available, so starting from the default values of this unknown parameters it was performed an adjustment to make the obtained characteristc under STC equal to that reported in the datasheet. Then it is computed the cell temperature using insolation, ambient air temperature and cell temperature at NOTC. Some other consideration have been made to compute the performance of the panel under these particular conditions and then, through the use of pvlib python library, the characteristic curve of the panels are predicted. 
The results obtained, at least on the small set of images used as a test, seem to be promising. Despite this, the proposed model remains merely a prototype that if enriched by the generalisation capability of a neural network, if the available data allow it, could greatly increase its reliability.

## Repository Structure
- `ANALISI GUASTI/`:
    - `faults/`: images of solar panels affected by faults to be used as examples.
- `ANALISI ZONE D_OMBRA/`:
    - `Documents/`: useful documents like the datasheet of the solar panel used as example to detect shadows;
    - `ELABORATED_IMAGES/`: examples of images obtained as shadows detecion system output;
    - Here it is necessary to put the downloaded dataset in a `DATASET/` folder to correctly run the code.
- `PRESENTATION/`: the pptx presentation describing the developed system.
- `Script.ipynb`: the code to test the entire developed system.
- `ShadowCideRawImages.py`: useful code if you want to use the non-rotated image version depicting solar panels affected by shadows.

## Feedback
For any feedback, questions or inquiries, please contact the project maintainers listed in the Contributors section.

